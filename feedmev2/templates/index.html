{% extends "base_pizzasystem.html" %}

{% block content %}

{% if order %}
    <h4>{{ order.date }}</h4>
    <table class="table table-striped table-bordered">
    <tr>
        <th>Menu item</th>
        <th>Soda</th>
        <th>Dressing</th>
        <th>Creator</th>
        <th>Buddy (NYI)</th>
        <th>Administration</th>
    </tr>
    {% for order_line in order.orderline_set.all %}
        <tr>
            <td>{{ order_line.menu_item }}</td>
            <td>{{ order_line.soda }}</td>
            {% if order_line.dressing %}
                <td><img class="icon" src="{{ STATIC_URL }}img/check.png"/></td>
            {% else %}
                <td><img class="icon" src="{{ STATIC_URL }}img/x.jpg"/></td>
            {% endif %}
            <td>{{ order_line.creator.username }}</td>
            <td>{{ order_line.buddy.username }}</td>
            {% if user == order_line.creator %}
                <td>
                    <a href="{% url "edit_orderline" order_line.id %}"><button class="btn btn-primary">edit</button></a>
                    <a href="{% url "delete_orderline" order_line.id %}"><button class="btn btn-danger">delete</button></a></td>
            {% elif user not in order_line.used_users and user != pizza.user and pizza.need_buddy %}
                <td><a href={% url "join_pizza" pizza.id %}><button class="btn btn-warning">join</button></a></td>
            {% else %}
                <td></td>
            {% endif %}
         </tr>
    {% endfor %}
    </table>
    {% if order.order_set.all %}
        <table class="table table-striped table-bordered">
        <tr>
            <th>User</th>
            <th>Description</th>
            <th></th>
        </tr>
        {% for order_line in order.order_set.all %}
            <tr>
                <td>{{ order_line.user }}</td>
                <td>{{ order_line.content }}</td>
                {% if user == order.user %}
                    <td><a href="{% url "edit_orderline" order.id %}"><button class="btn btn-primary">edit</button></a>
                    <a href="{% url "delete_orderline" order.id %}"><button class="btn btn-danger">delete</button></a></td>
                {% else %}
                    <td></td>
                {% endif %}
            </tr>
        {% endfor %}
        </table>
    {% endif %}
    {% if user.id not in order.taken_users %}
        <a href="{% url "new_orderline" %}"><button class="btn btn-primary">Ny bestilling</button></a>
    {% endif %}
    <!--<a href="{% url "new_orderline" %}"><button class="btn btn-primary">Annet</button></a>-->
{% else %}
    <p>No orders available.</p>
{% endif %}
{% endblock content %}
